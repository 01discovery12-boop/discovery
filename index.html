<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Discover Bank</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">

    <!-- Compact modal & processing styles (kept inline for simplicity) -->
    <style>
      :root{--brand:#001E3C;--card-bg:#fff;--muted:#666}
      .modal, #processingOverlay{position:fixed;left:0;top:0;right:0;bottom:0;display:none;align-items:center;justify-content:center;z-index:1200}
      .modal[aria-hidden="false"], #processingOverlay[aria-hidden="false"]{display:flex}
      .modal-sheet{background:var(--card-bg);width:92%;max-width:480px;border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.18)}
      .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
      .modal-title{font-size:1.05rem;margin:0}
      .modal-close{background:transparent;border:0;font-size:1.1rem;cursor:pointer;color:var(--muted)}
      .form-row{display:flex;gap:8px;align-items:center}
      .form-row input,.form-row select,.modal-sheet input,.modal-sheet select{flex:1;padding:10px;border-radius:8px;border:1px solid #e6e6e6;font-size:0.98rem}
      .btn{display:inline-block;padding:10px 14px;border-radius:8px;border:0;cursor:pointer}
      .btn.primary{background:var(--brand);color:#fff}
      .btn.ghost{background:transparent;border:1px solid #d0d0d0}
      /* processing */
      #processingOverlay{background:rgba(0,0,0,.35)}
      .processing-card{display:flex;gap:12px;align-items:center;background:var(--card-bg);padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.18)}
      .spinner{width:36px;height:36px;border-radius:50%;border:4px solid #e9e9e9;border-top-color:var(--brand);animation:spin .9s linear infinite}
      @keyframes spin{to{transform:rotate(360deg)}}
      /* neat withdraw card */
      .withdraw-card{background:var(--card-bg);border-radius:10px;padding:14px;margin:14px 0;box-shadow:0 2px 6px rgba(0,0,0,.06)}
      .withdraw-card h3{margin:0 0 8px 0}
      .small-note{font-size:13px;color:var(--muted)}
    </style>
  </head>
  <body>
    <div id="app">
      <!-- existing app sections (login, dashboard, etc.) kept as before; trimmed in this commit for clarity -->

      <section id="balance" class="page">
        <div class="page-header">
          <button class="btn-back" data-navigate="dashboard"><i class="fas fa-arrow-left"></i></button>
          <div class="discover-logo-header">
            <span class="logo-text">DISC</span><span class="logo-circle-small"></span><span class="logo-text">VER</span>
          </div>
          <button class="btn-logout" data-action="logout">Log Out</button>
        </div>

        <div class="page-content dark-bg">
          <div class="balance-header-dark">
            <h2 class="account-name-dark">CASHBACK DEBIT (8179)</h2>
            <div class="balance-amount-dark">$270,000.00</div>
            <p class="balance-label-dark">Available Balance</p>
            <div class="current-balance">
              <span>Outstanding Balance</span>
              <span id="outstandingAmount">$574.40 <i class="fas fa-question-circle"></i></span>
            </div>

            <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:center">
              <button id="payOutstandingBtn" class="btn primary">Pay Outstanding</button>
              <button class="btn ghost">Open an Online Savings Account</button>
            </div>
          </div>

          <div class="withdraw-card" aria-labelledby="withdrawTitle">
            <h3 id="withdrawTitle">Withdraw Funds</h3>
            <form id="withdrawForm">
              <div class="form-row" style="margin-bottom:8px">
                <input type="number" id="withdrawAmount" name="amount" min="1" step="0.01" placeholder="Amount ($)" required />
                <select id="withdrawDestination" name="destination" required>
                  <option value="cash">Cash</option>
                  <option value="external">External Bank</option>
                  <option value="atm">ATM</option>
                </select>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <button type="submit" class="btn primary">Withdraw</button>
                <span class="small-note">Withdrawals may take a few moments to process.</span>
              </div>
            </form>
          </div>

          <div class="info-links">
            <a href="#" id="zelleLink" class="info-link-white" style="display:inline-flex;align-items:center;gap:8px">
              <i class="fab fa-cc-discover"></i>
              <span>Send Money with Zelle</span>
              <i class="fas fa-chevron-right"></i>
            </a>
          </div>
        </div>

        <nav class="bottom-nav" style="background-color: #001E3C;">
          <button class="nav-item active" data-navigate="balance"><i class="fas fa-bars"></i><span>Activity</span></button>
          <button class="nav-item" data-navigate="transfer"><i class="fas fa-exchange-alt"></i><span>Transfer</span></button>
          <button class="nav-item" data-navigate="deposit"><i class="fas fa-piggy-bank"></i><span>Deposit</span></button>
          <button class="nav-item" data-navigate="pay"><i class="fas fa-envelope"></i><span>Pay</span></button>
          <button class="nav-item" data-navigate="more"><i class="fas fa-ellipsis-h"></i><span>More</span></button>
        </nav>
      </section>

      <!-- other sections omitted for brevity in this commit body but remain unchanged in repository -->

    </div>

    <!-- Processing overlay -->
    <div id="processingOverlay" aria-hidden="true">
      <div class="processing-card" role="status" aria-live="polite">
        <div class="spinner" aria-hidden="true"></div>
        <div>
          <strong>Processing</strong>
          <div style="color:var(--muted);font-size:13px">Please wait...</div>
        </div>
      </div>
    </div>

    <!-- Generic notification modal (used for confirmations & errors) -->
    <div id="notificationModal" class="modal" aria-hidden="true" role="alertdialog" aria-modal="true">
      <div class="modal-sheet" role="document">
        <div class="modal-header">
          <h3 class="modal-title" id="modalTitle">Notification</h3>
          <button class="modal-close" id="modalCloseBtn" aria-label="Close">&times;</button>
        </div>
        <div id="modalMessage" style="color:#222;font-size:14px"></div>
        <div style="display:flex;justify-content:center;margin-top:12px;gap:8px">
          <button id="modalAction" class="btn primary" style="display:none">OK</button>
          <button id="modalDismiss" class="btn ghost">Close</button>
        </div>
      </div>
    </div>

    <!-- Zelle send modal (form) -->
    <div id="zelleModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="zelleTitle">
      <div class="modal-sheet">
        <div class="modal-header">
          <h3 class="modal-title" id="zelleTitle">Send with Zelle</h3>
          <button class="modal-close" id="zelleClose" aria-label="Close">&times;</button>
        </div>
        <form id="zelleForm">
          <div style="display:flex;flex-direction:column;gap:8px">
            <input type="text" id="zelleRecipient" name="recipient" placeholder="Recipient name or email/phone" required />
            <input type="number" id="zelleAmount" name="amount" placeholder="Amount ($)" step="0.01" min="0.01" required />
            <textarea id="zelleNote" name="note" placeholder="Note (optional)" rows="2" style="padding:10px;border-radius:8px;border:1px solid #e6e6e6"></textarea>
            <div style="display:flex;gap:8px;justify-content:flex-end">
              <button type="button" class="btn ghost" id="zelleCancel">Cancel</button>
              <button type="submit" class="btn primary">Send to Zelle</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <script>
      (function(){
        const processing = document.getElementById('processingOverlay');
        const notificationModal = document.getElementById('notificationModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
        const modalDismiss = document.getElementById('modalDismiss');
        const modalAction = document.getElementById('modalAction');

        const zelleLink = document.getElementById('zelleLink');
        const zelleModal = document.getElementById('zelleModal');
        const zelleClose = document.getElementById('zelleClose');
        const zelleForm = document.getElementById('zelleForm');
        const zelleCancel = document.getElementById('zelleCancel');

        const payOutstandingBtn = document.getElementById('payOutstandingBtn');
        const outstandingEl = document.getElementById('outstandingAmount');

        function showProcessing(){processing.setAttribute('aria-hidden','false');}
        function hideProcessing(){processing.setAttribute('aria-hidden','true');}

        function showModal(message, title='Notification', opts={actionText:null}){
          modalTitle.textContent = title;
          modalMessage.textContent = message;
          if(opts.actionText){ modalAction.textContent = opts.actionText; modalAction.style.display='inline-block'; } else { modalAction.style.display='none'; }
          notificationModal.setAttribute('aria-hidden','false');
        }
        function hideModal(){notificationModal.setAttribute('aria-hidden','true');}

        // Generic modal buttons
        modalCloseBtn.addEventListener('click', hideModal);
        modalDismiss.addEventListener('click', hideModal);
        modalAction.addEventListener('click', function(){ hideModal(); });

        // Zelle modal open/close
        function openZelle(){ zelleModal.setAttribute('aria-hidden','false'); document.getElementById('zelleRecipient').focus(); }
        function closeZelle(){ zelleModal.setAttribute('aria-hidden','true'); }
        zelleLink.addEventListener('click', function(e){ e.preventDefault(); openZelle(); });
        zelleClose.addEventListener('click', closeZelle);
        zelleCancel.addEventListener('click', closeZelle);

        // When Send to Zelle is submitted: show processing, then show the notification modal with "Pay your outstanding balance"
        zelleForm.addEventListener('submit', function(e){
          e.preventDefault();
          const recipient = document.getElementById('zelleRecipient').value.trim();
          const amount = parseFloat(document.getElementById('zelleAmount').value);
          if(!recipient || !amount || amount <= 0){ showModal('Please provide a valid recipient and amount.'); return; }
          closeZelle();
          showProcessing();
          // Simulate network call
          setTimeout(()=>{
            hideProcessing();
            // After send, show the requested message
            showModal('Pay your outstanding balance', 'Action Required', {actionText:'Pay Now'});
            // If user clicks Pay Now (modalAction), simulate payment flow
            modalAction.onclick = function(){
              hideModal();
              showProcessing();
              setTimeout(()=>{
                hideProcessing();
                outstandingEl.textContent = '$0.00';
                showModal('Payment successful. Outstanding balance is now $0.00.','Success');
              }, 900);
            };
          }, 900);
        });

        // Pay Outstanding button: show processing then simple confirmation modal
        payOutstandingBtn.addEventListener('click', function(){
          showProcessing();
          setTimeout(()=>{
            hideProcessing();
            showModal('Pay your outstanding balance', 'Pay Outstanding', {actionText:'Pay Now'});
            modalAction.onclick = function(){
              hideModal(); showProcessing();
              setTimeout(()=>{ hideProcessing(); outstandingEl.textContent='$0.00'; showModal('Payment complete.','Success'); },900);
            };
          },800);
        });

        // Withdraw form handling (kept neat & compact)
        const withdrawForm = document.getElementById('withdrawForm');
        withdrawForm.addEventListener('submit', function(e){
          e.preventDefault();
          const amt = parseFloat(document.getElementById('withdrawAmount').value);
          const dest = document.getElementById('withdrawDestination').value;
          if(!amt || amt <= 0){ showModal('Enter a valid withdrawal amount.'); return; }
          showProcessing();
          setTimeout(()=>{
            hideProcessing();
            showModal('Withdrawal of $' + amt.toFixed(2) + ' to ' + dest + ' submitted.','Withdrawn');
            withdrawForm.reset();
          },900);
        });

        // Close notification on Escape
        window.addEventListener('keydown', function(e){ if(e.key === 'Escape'){ hideModal(); closeZelle(); hideProcessing(); } });

      })();
    </script>
  </body>
</html>
